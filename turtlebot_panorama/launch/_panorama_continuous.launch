<!-- 
  Continuously takes photos and stitches them together
 -->
<launch>
  <arg name="pano_ros_server_name" value="pano_server"/>
  <arg name="turtlebot_panorama_name" value="turtlebot_panorama"/>
  <arg name="base" value="$(optenv TURTLEBOT_BASE kobuki)"/>
  
  <!-- Load base-specific stuff -->
  <include file="$(find turtlebot_panorama)/launch/$(arg base)/_base_specific.launch"/>

  <!-- 3d sensor; ensure that the nodelet manager is named camera_nodelet_manager! -->
  <include file="$(find turtlebot_bringup)/launch/3dsensor.launch">
    <arg name="use_openni_launch" value="false"/>
  </include>

  <node name="$(arg pano_ros_server_name)" pkg="pano_ros" type="capture_server.py">
    <remap from="/$(arg pano_ros_server_name)/" to="$(arg turtlebot_panorama_name)/pano_server/"/>
    <remap from="/$(arg pano_ros_server_name)/snap" to="$(arg turtlebot_panorama_name)/pano_server/snap"/>
    <remap from="/$(arg pano_ros_server_name)/stop" to="$(arg turtlebot_panorama_name)/pano_server/stop"/>
    <remap from="/$(arg pano_ros_server_name)/stitch" to="$(arg turtlebot_panorama_name)/pano_server/stitch"/>
  </node>
  <node name="$(arg turtlebot_panorama_name)" pkg="turtlebot_panorama" type="panorama_cont">
    <param name="cmd_vel_name" value="cmd_vel"/>
    <param name="odometry_name" value="/odom"/>
    <remap from="$(arg turtlebot_panorama_name)/cmd_vel" to="panorama_vel_smoother/raw_cmd_vel"/>
  </node>
</launch>
